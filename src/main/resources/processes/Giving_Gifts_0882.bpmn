<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/processdef">
  <process id="givingGifts_0882" name="Giving_Gifts_0882" isExecutable="true">
    <documentation>Giving gifts for company : Bayer HealthCare Co. Ltd 
Company Code is 0882</documentation>
    <startEvent id="start_event" name="开始"/>
    <serviceTask id="task_send_mail_line_manager" name="发送邮件给Line Manager"
                 activiti:class="com.bayer.gifts.activiti.extension.GiftsNotifMailDelegate" >
      <extensionElements>
            <activiti:field name="notifType" stringValue="LINE_MANAGER"/>
            <activiti:taskListener event="complete" class="com.bayer.gifts.activiti.listener.CustomerTaskListener"/>
      </extensionElements>
    </serviceTask>
    <exclusiveGateway id="gateway_desc_type" name="礼品是否是Other类型?"/>
    <endEvent id="line_manager_to_end_event" name="结束"/>
    <serviceTask id="task_send_mail_sco" name="发送邮件给SCO"
                 activiti:class="com.bayer.gifts.activiti.extension.GiftsNotifMailDelegate">
        <extensionElements>
            <activiti:field name="notifType" stringValue="SCO_GROUP"/>
            <activiti:taskListener event="complete" class="com.bayer.gifts.activiti.listener.CustomerTaskListener"/>
        </extensionElements>
    </serviceTask>
    <userTask id="task_user_sco" name="SCO 审批"
              activiti:candidateUsers="${applyGivingGiftsVar.scoGroupUsers}"/>
    <exclusiveGateway id="gateway_sco" name="SCO是否同意申请"/>
      <serviceTask id="task_send_mail_request" name="发送邮件给Requester"
                   activiti:class="com.bayer.gifts.activiti.extension.GiftsNotifMailDelegate">
          <extensionElements>
              <activiti:taskListener event="complete" class="com.bayer.gifts.activiti.listener.CustomerTaskListener"/>
          </extensionElements>
      </serviceTask>
    <endEvent id="sco_to_end_event"/>
    <sequenceFlow id="follow_cultrual_courtesy_to_send_mail" name="礼品类型为 Cultrual Courtes" sourceRef="gateway_desc_type" targetRef="task_send_mail_line_manager">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${applyGivingGiftsVar.giftDescType=='Cultural Courtesy Gifts'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_other_to_send_mail" name="礼品类型为 Other" sourceRef="gateway_desc_type" targetRef="task_send_mail_sco">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${applyGivingGiftsVar.giftDescType=='Other'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_send_mail_to_sco" sourceRef="task_send_mail_sco" targetRef="task_user_sco" />
    <sequenceFlow id="follow_sco_reject" name="拒绝" sourceRef="gateway_sco" targetRef="task_send_mail_line_manager">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${applyGivingGiftsVar.scoApproved=='false'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_start_to_gateway" sourceRef="start_event" targetRef="gateway_desc_type"/>
    <sequenceFlow id="follow_sco_to_gateway" sourceRef="task_user_sco" targetRef="gateway_sco"/>
    <sequenceFlow id="follow_sco_approve" name="同意" sourceRef="gateway_sco" targetRef="task_send_mail_request">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${applyGivingGiftsVar.scoApproved=='true'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_line_manager_to_end" sourceRef="task_send_mail_line_manager" targetRef="line_manager_to_end_event"/>
    <sequenceFlow id="follow_sco_to_end" sourceRef="task_send_mail_request" targetRef="sco_to_end_event"/>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_givingGifts_0882">
    <bpmndi:BPMNPlane bpmnElement="givingGifts_0882" id="BPMNPlane_givingGifts_0882">
      <bpmndi:BPMNShape bpmnElement="start_event" id="BPMNShape_start_event">
        <omgdc:Bounds height="30.0" width="29.999999999999993" x="60.00000413258949" y="170.00001526762247"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_send_mail_line_manager" id="BPMNShape_task_send_mail_line_manager">
        <omgdc:Bounds height="80.0" width="100.0" x="285.0000065432666" y="60.0000013775298"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="gateway_desc_type" id="BPMNShape_gateway_desc_type">
        <omgdc:Bounds height="40.0" width="40.0" x="180.0000123977685" y="165.00001136462112"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="line_manager_to_end_event" id="BPMNShape_line_manager_to_end_event">
        <omgdc:Bounds height="28.0" width="27.999999999999886" x="495.0000340938633" y="86.0000033519892"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_send_mail_sco" id="BPMNShape_task_send_mail_sco">
        <omgdc:Bounds height="79.99999999999991" width="100.0" x="285.0000065432666" y="255.00000585450167"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_user_sco" id="BPMNShape_task_user_sco">
        <omgdc:Bounds height="80.00000000000006" width="99.99999999999989" x="480.00005510119433" y="255.0000117090034"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="gateway_sco" id="BPMNShape_gateway_sco">
        <omgdc:Bounds height="40.0" width="40.0" x="660.000030305656" y="275.00003019086273"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_send_mail_request" id="BPMNShape_task_send_mail_request">
        <omgdc:Bounds height="79.99999999999997" width="100.0" x="780.0001074473307" y="255.00002387718396"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="sco_to_end_event" id="BPMNShape_sco_to_end_event">
        <omgdc:Bounds height="28.0" width="28.0" x="975.0000447697191" y="281.0000181604349"/>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="follow_sco_to_gateway" id="BPMNEdge_follow_sco_to_gateway">
        <omgdi:waypoint x="580.0000551011942" y="295.1661308333355"/>
        <omgdi:waypoint x="660.4333611555063" y="295.433361040713"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_sco_approve" id="BPMNEdge_follow_sco_approve">
        <omgdi:waypoint x="699.5637894697094" y="295.43627102680927"/>
        <omgdi:waypoint x="780.0001074473307" y="295.16724998276146"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_sco_to_end" id="BPMNEdge_follow_sco_to_end">
        <omgdi:waypoint x="880.0001074473307" y="295.0000220794634"/>
        <omgdi:waypoint x="975.0000447697191" y="295.00001866379665"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_line_manager_to_end" id="BPMNEdge_follow_line_manager_to_end">
        <omgdi:waypoint x="385.0000065432666" y="100.0000019449031"/>
        <omgdi:waypoint x="495.0000340938633" y="100.00000319312468"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_cultrual_courtesy_to_send_mail" id="BPMNEdge_follow_cultrual_courtesy_to_send_mail">
        <omgdi:waypoint x="200.5000123977685" y="165.50001136462112"/>
        <omgdi:waypoint x="200.5000123977685" y="100.0000013775298"/>
        <omgdi:waypoint x="285.0000065432666" y="100.0000013775298"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_start_to_gateway" id="BPMNEdge_follow_start_to_gateway">
        <omgdi:waypoint x="90.00000413258948" y="185.00001479926235"/>
        <omgdi:waypoint x="180.00001302224865" y="185.00001198910127"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_send_mail_to_sco" id="BPMNEdge_follow_send_mail_to_sco">
        <omgdi:waypoint x="385.0000065432666" y="295.00000735565555"/>
        <omgdi:waypoint x="480.00005510119433" y="295.0000102078495"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_sco_reject" id="BPMNEdge_follow_sco_reject">
        <omgdi:waypoint x="680.500030305656" y="275.50003019086273"/>
        <omgdi:waypoint x="680.500030305656" y="167.02314268571405"/>
        <omgdi:waypoint x="335.0000065432666" y="167.02314268571405"/>
        <omgdi:waypoint x="335.0000065432666" y="140.0000013775298"/>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="edge-8dfc313c-41e1-4464-a9dc-a46aefd9df82" bpmnElement="follow_other_to_send_mail">
        <omgdi:waypoint x="200.00002" y="205.00002"/>
        <omgdi:waypoint x="200.0" y="295.0"/>
        <omgdi:waypoint x="285.0" y="295.0"/>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
