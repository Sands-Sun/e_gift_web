<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:activiti="http://activiti.org/bpmn" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" typeLanguage="http://www.w3.org/2001/XMLSchema" expressionLanguage="http://www.w3.org/1999/XPath" targetNamespace="http://www.activiti.org/processdef">
  <process id="givingGifts_0813" name="Giving_Gifts_0813" isExecutable="true">
    <documentation>Giving gifts for company : Bayer HealthCare Co. Ltd
Company Code is 0813</documentation>
    <startEvent id="startEvent1" name="start_event"></startEvent>
    <userTask id="task_user_line_manager" name="Line Manager 审批" activiti:candidateUsers="${applyGivingGiftsVar.lineManagerUsers}">
        <extensionElements>
            <activiti:executionListener event="end" delegateExpression="${giftsExecutionListener}">
                <activiti:field name="needApprove">
                    <activiti:string><![CDATA[true]]></activiti:string>
                </activiti:field>
            </activiti:executionListener>
        </extensionElements>
    </userTask>
    <exclusiveGateway id="lm_gateway"></exclusiveGateway>
    <serviceTask id="task_send_mail_to_requester" name="发送邮件给 Requester" activiti:delegateExpression="${giftsNotifMailDelegate}">
        <documentation>${applyGivingGiftsVar.getRemarks()}</documentation>
        <extensionElements>
            <activiti:field name="notifType">
                <activiti:string><![CDATA[REQUESTER]]></activiti:string>
            </activiti:field>
            <activiti:field name="fromGroup">
                <activiti:string><![CDATA[LINE_MANAGER]]></activiti:string>
            </activiti:field>
        </extensionElements>
    </serviceTask>
    <endEvent id="end_event" name="结束"></endEvent>
    <exclusiveGateway id="non_government_min_price_gateway"></exclusiveGateway>
    <serviceTask id="task_send_mail_department_head" name="发送邮件给 Department Head" activiti:delegateExpression="${giftsNotifMailDelegate}">
        <extensionElements>
            <activiti:field name="notifType">
                <activiti:string><![CDATA[DEPARTMENT_HEAD]]></activiti:string>
            </activiti:field>
            <activiti:field name="fromGroup">
                <activiti:string><![CDATA[LINE_MANAGER]]></activiti:string>
            </activiti:field>
        </extensionElements>
    </serviceTask>
    <userTask id="task_user_department_head" name="Department Head 审批" activiti:candidateUsers="${applyGivingGiftsVar.departmentHeadGroupUsers}">
        <extensionElements>
            <activiti:executionListener event="end" delegateExpression="${giftsExecutionListener}">
                <activiti:field name="needApprove">
                    <activiti:string><![CDATA[true]]></activiti:string>
                </activiti:field>
            </activiti:executionListener>
        </extensionElements>
    </userTask>
    <exclusiveGateway id="dept_head_gateway"></exclusiveGateway>
    <serviceTask id="task_dept_heand_reject_send_mail_to_requester" name="发送邮件给 Requester" activiti:delegateExpression="${giftsNotifMailDelegate}">
        <documentation>${applyGivingGiftsVar.getRemarks()}</documentation>
        <extensionElements>
            <activiti:field name="notifType">
                <activiti:string><![CDATA[REQUESTER]]></activiti:string>
            </activiti:field>
            <activiti:field name="fromGroup">
                <activiti:string><![CDATA[DEPARTMENT_HEAD]]></activiti:string>
            </activiti:field>
        </extensionElements>
    </serviceTask>
    <exclusiveGateway id="government_or_hcp_and_less_than_min_price_gateway"></exclusiveGateway>
    <serviceTask id="task_send_mail_sco" name="发送邮件给 SCO" activiti:delegateExpression="${giftsNotifMailDelegate}">
        <extensionElements>
            <activiti:field name="notifType">
                <activiti:string><![CDATA[SCO_GROUP]]></activiti:string>
            </activiti:field>
        </extensionElements>
    </serviceTask>
    <userTask id="task_user_sco" name="SCO 审批" activiti:candidateUsers="${applyGivingGiftsVar.scoGroupUserPair}">
        <extensionElements>
            <activiti:executionListener event="end" delegateExpression="${giftsExecutionListener}">
                <activiti:field name="needApprove">
                    <activiti:string><![CDATA[true]]></activiti:string>
                </activiti:field>
            </activiti:executionListener>
        </extensionElements>
    </userTask>
    <serviceTask id="task_sco_send_mail_to_requester" name="发送邮件给 Requester"  activiti:delegateExpression="${giftsNotifMailDelegate}">
        <documentation>${applyGivingGiftsVar.getRemarks()}</documentation>
        <extensionElements>
            <activiti:field name="notifType">
                <activiti:string><![CDATA[REQUESTER]]></activiti:string>
            </activiti:field>
            <activiti:field name="fromGroup">
                <activiti:string><![CDATA[SCO_GROUP]]></activiti:string>
            </activiti:field>
        </extensionElements>
    </serviceTask>
    <serviceTask id="task_send_mail_line_manager" name="发送邮件给Line Manager" activiti:delegateExpression="${giftsNotifMailDelegate}">
      <extensionElements>
        <activiti:field name="notifType">
          <activiti:string><![CDATA[LINE_MANAGER]]></activiti:string>
        </activiti:field>
      </extensionElements>
    </serviceTask>
    <sequenceFlow id="follow_reject_dept_head_from_requester_to_end" sourceRef="task_dept_heand_reject_send_mail_to_requester" targetRef="end_event"></sequenceFlow>
    <sequenceFlow id="follow_start_event_to_line_manager" sourceRef="startEvent1" targetRef="task_send_mail_line_manager"></sequenceFlow>
    <sequenceFlow id="follow_send_mail_lm_to_user_lm" sourceRef="task_send_mail_line_manager" targetRef="task_user_line_manager"></sequenceFlow>
    <sequenceFlow id="follow_lm_to_gateway" sourceRef="task_user_line_manager" targetRef="lm_gateway"></sequenceFlow>
    <sequenceFlow id="follow_lm_reject" name="拒绝" sourceRef="lm_gateway" targetRef="task_send_mail_to_requester">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${taskVariable.approve=='Rejected'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_lm_approve" name="同意" sourceRef="lm_gateway" targetRef="non_government_min_price_gateway">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${taskVariable.approve=='Approved'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_non_government_and_less_than_min_price" name="接受人员为非政府官员且礼品金额≤300元/人" sourceRef="non_government_min_price_gateway" targetRef="task_send_mail_to_requester">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${applyGivingGiftsVar.isGoSoc =='No' && applyGivingGiftsVar.unitValue <= 300}]]>
        </conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_lm_other" sourceRef="non_government_min_price_gateway" targetRef="task_send_mail_department_head">
      <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(applyGivingGiftsVar.isGoSoc =='Yes' || applyGivingGiftsVar.isGoSoc == 'HCP') ||(applyGivingGiftsVar.isGoSoc =='No' && applyGivingGiftsVar.unitValue > 300)}]]>
      </conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_reject_lm_from_requester_to_end" sourceRef="task_send_mail_to_requester" targetRef="end_event"></sequenceFlow>
    <sequenceFlow id="follow_dept_head_to_gateway" sourceRef="task_user_department_head" targetRef="dept_head_gateway"></sequenceFlow>
    <sequenceFlow id="follow_dept_head_approve" name="同意" sourceRef="dept_head_gateway" targetRef="government_or_hcp_and_less_than_min_price_gateway">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${taskVariable.approve=='Approved'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_dept_head_reject" name="拒绝" sourceRef="dept_head_gateway" targetRef="task_dept_heand_reject_send_mail_to_requester">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${taskVariable.approve=='Rejected'}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_government_or_hcp_and_less_than_min_price" name="接受人员为政府官员/HCP且礼品金额≤200元/人" sourceRef="government_or_hcp_and_less_than_min_price_gateway" targetRef="task_dept_heand_reject_send_mail_to_requester">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${(applyGivingGiftsVar.isGoSoc =='Yes' || applyGivingGiftsVar.isGoSoc == 'HCP')  && applyGivingGiftsVar.unitValue <= 200}]]></conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_dept_head_other" sourceRef="government_or_hcp_and_less_than_min_price_gateway" targetRef="task_send_mail_sco">
        <conditionExpression xsi:type="tFormalExpression"><![CDATA[${applyGivingGiftsVar.giftDescType == 'Medicine Gift' || ((applyGivingGiftsVar.isGoSoc =='Yes' || applyGivingGiftsVar.isGoSoc == 'HCP')  && applyGivingGiftsVar.unitValue > 200) || (applyGivingGiftsVar.isGoSoc =='No' && applyGivingGiftsVar.unitValue > 300)}]]>
        </conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="follow_send_mail_dept_head_to_user_dept_head" sourceRef="task_send_mail_department_head" targetRef="task_user_department_head"></sequenceFlow>
    <sequenceFlow id="follow_send_mail_sco_to_user_sco" sourceRef="task_send_mail_sco" targetRef="task_user_sco"></sequenceFlow>
    <sequenceFlow id="follow_sco_to_requester" sourceRef="task_user_sco" targetRef="task_sco_send_mail_to_requester"></sequenceFlow>
    <sequenceFlow id="follow_sco_from_requester_to_end" sourceRef="task_sco_send_mail_to_requester" targetRef="end_event"></sequenceFlow>
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_Giving_Gifts_0813">
    <bpmndi:BPMNPlane bpmnElement="Giving_Gifts_0813" id="BPMNPlane_Giving_Gifts_0813">
      <bpmndi:BPMNShape bpmnElement="startEvent1" id="BPMNShape_startEvent1">
        <omgdc:Bounds height="30.0" width="29.999999999999996" x="25.402631605422588" y="224.0000153364988"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_user_line_manager" id="BPMNShape_task_user_line_manager">
        <omgdc:Bounds height="80.0" width="100.0" x="315.00000723203146" y="199.00000973454405"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="lm_gateway" id="BPMNShape_lm_gateway">
        <omgdc:Bounds height="40.0" width="40.0" x="510.0000351270106" y="219.00001019372064"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_send_mail_to_requester" id="BPMNShape_task_send_mail_to_requester">
        <omgdc:Bounds height="79.99999999999999" width="100.0" x="690.0000158415927" y="15.000001974459447"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="end_event" id="BPMNShape_end_event">
        <omgdc:Bounds height="28.0" width="28.0" x="1485.0000340938625" y="225.00000516573675"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="non_government_min_price_gateway" id="BPMNShape_non_government_min_price_gateway">
        <omgdc:Bounds height="40.0" width="40.0" x="615.0000416702775" y="355.0000198593883"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_send_mail_department_head" id="BPMNShape_task_send_mail_department_head">
        <omgdc:Bounds height="80.0" width="100.0" x="720.0000991821514" y="405.0000092983262"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_user_department_head" id="BPMNShape_task_user_department_head">
        <omgdc:Bounds height="80.0" width="100.0" x="863.6894349257693" y="405.00002789497916"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="dept_head_gateway" id="BPMNShape_dept_head_gateway">
        <omgdc:Bounds height="40.0" width="40.0" x="1035.0000712871688" y="425.00003765248255"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_dept_heand_reject_send_mail_to_requester" id="BPMNShape_task_dept_heand_reject_send_mail_to_requester">
        <omgdc:Bounds height="80.00000000000003" width="99.99999999999977" x="1100.0001231970875" y="135.00000309944207"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="government_or_hcp_and_less_than_min_price_gateway" id="BPMNShape_government_or_hcp_and_less_than_min_price_gateway">
        <omgdc:Bounds height="39.99999999999994" width="40.0" x="1130.0000466064255" y="510.00001170900333"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_send_mail_sco" id="BPMNShape_task_send_mail_sco">
        <omgdc:Bounds height="79.99999999999989" width="100.0" x="1200.000027550596" y="585.0000268618313"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_user_sco" id="BPMNShape_task_user_sco">
        <omgdc:Bounds height="80.0" width="100.0" x="1345.000027550596" y="585.0000268618312"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_sco_send_mail_to_requester" id="BPMNShape_task_sco_send_mail_to_requester">
        <omgdc:Bounds height="80.00000000000006" width="99.99999999999977" x="1345.0000584302231" y="375.00000860956123"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape bpmnElement="task_send_mail_line_manager" id="BPMNShape_task_send_mail_line_manager">
        <omgdc:Bounds height="80.0" width="99.99999999999991" x="135.00000309944207" y="199.00000973454405"></omgdc:Bounds>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge bpmnElement="follow_reject_dept_head_from_requester_to_end" id="BPMNEdge_follow_reject_dept_head_from_requester_to_end">
        <omgdi:waypoint x="1200.0001231970873" y="175.00000309944207"></omgdi:waypoint>
        <omgdi:waypoint x="1499.0000340938625" y="175.00000309944207"></omgdi:waypoint>
        <omgdi:waypoint x="1499.0000340938625" y="225.00000516573675"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_reject_lm_from_requester_to_end" id="BPMNEdge_follow_reject_lm_from_requester_to_end">
        <omgdi:waypoint x="790.0000158415927" y="55.00000197445944"></omgdi:waypoint>
        <omgdi:waypoint x="1499.0000340938625" y="55.000001974459444"></omgdi:waypoint>
        <omgdi:waypoint x="1499.0000340938625" y="225.00000516573675"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_dept_head_approve" id="BPMNEdge_follow_dept_head_approve">
        <omgdi:waypoint x="1055.5000712871688" y="464.50003765248255"></omgdi:waypoint>
        <omgdi:waypoint x="1055.5000712871688" y="530.5000117090033"></omgdi:waypoint>
        <omgdi:waypoint x="1130.5000466064255" y="530.5000117090033"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_lm_approve" id="BPMNEdge_follow_lm_approve">
        <omgdi:waypoint x="530.5000351270106" y="258.50001019372064"></omgdi:waypoint>
        <omgdi:waypoint x="530.5000351270106" y="375.5000198593883"></omgdi:waypoint>
        <omgdi:waypoint x="615.5000416702775" y="375.5000198593883"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_send_mail_sco_to_user_sco" id="BPMNEdge_follow_send_mail_sco_to_user_sco">
        <omgdi:waypoint x="1300.000027550596" y="625.0000268618313"></omgdi:waypoint>
        <omgdi:waypoint x="1345.000027550596" y="625.0000268618312"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_lm_reject" id="BPMNEdge_follow_lm_reject">
        <omgdi:waypoint x="530.5000351270106" y="219.50001019372064"></omgdi:waypoint>
        <omgdi:waypoint x="530.5000351270106" y="55.00000197445944"></omgdi:waypoint>
        <omgdi:waypoint x="690.0000158415927" y="55.00000197445944"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_government_or_hcp_and_less_than_min_price" id="BPMNEdge_follow_government_or_hcp_and_less_than_min_price">
        <omgdi:waypoint x="1150.4718819140674" y="510.47184701664526"></omgdi:waypoint>
        <omgdi:waypoint x="1150.056373368365" y="215.0000030994421"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_send_mail_lm_to_user_lm" id="BPMNEdge_follow_send_mail_lm_to_user_lm">
        <omgdi:waypoint x="235.00000309944198" y="239.00000973454405"></omgdi:waypoint>
        <omgdi:waypoint x="315.00000723203146" y="239.00000973454405"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_non_government_and_less_than_min_price" id="BPMNEdge_follow_non_government_and_less_than_min_price">
        <omgdi:waypoint x="654.5000416702775" y="375.5000198593883"></omgdi:waypoint>
        <omgdi:waypoint x="740.0000158415927" y="375.5000198593883"></omgdi:waypoint>
        <omgdi:waypoint x="740.0000158415927" y="95.00000197445944"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_sco_to_requester" id="BPMNEdge_follow_sco_to_requester">
        <omgdi:waypoint x="1395.0000334324293" y="585.0000268618312"></omgdi:waypoint>
        <omgdi:waypoint x="1395.0000525483897" y="455.0000086095613"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_lm_to_gateway" id="BPMNEdge_follow_lm_to_gateway">
        <omgdi:waypoint x="415.00000723203146" y="239.1510672496201"></omgdi:waypoint>
        <omgdi:waypoint x="510.4394290208242" y="239.43940408753426"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_lm_other" id="BPMNEdge_follow_lm_other">
        <omgdi:waypoint x="635.5000416702775" y="394.5000198593883"></omgdi:waypoint>
        <omgdi:waypoint x="635.5000416702775" y="445.0000092983262"></omgdi:waypoint>
        <omgdi:waypoint x="720.0000991821514" y="445.0000092983262"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_dept_head_to_gateway" id="BPMNEdge_follow_dept_head_to_gateway">
        <omgdi:waypoint x="963.6894349257693" y="445.17632276620066"></omgdi:waypoint>
        <omgdi:waypoint x="1035.4293038198493" y="445.4292701851632"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_start_event_to_line_manager" id="BPMNEdge_follow_start_event_to_line_manager">
        <omgdi:waypoint x="55.40263160542257" y="239.00001475537258"></omgdi:waypoint>
        <omgdi:waypoint x="135.00000309944207" y="239.0000116716314"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_dept_head_reject" id="BPMNEdge_follow_dept_head_reject">
        <omgdi:waypoint x="1055.5000712871688" y="425.50003765248255"></omgdi:waypoint>
        <omgdi:waypoint x="1055.5000712871688" y="175.0000030994421"></omgdi:waypoint>
        <omgdi:waypoint x="1100.0001231970875" y="175.0000030994421"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_send_mail_dept_head_to_user_dept_head" id="BPMNEdge_follow_send_mail_dept_head_to_user_dept_head">
        <omgdi:waypoint x="820.0000991821514" y="445.0000157694581"></omgdi:waypoint>
        <omgdi:waypoint x="863.6894349257693" y="445.0000214238472"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_dept_head_other" id="BPMNEdge_follow_dept_head_other">
        <omgdi:waypoint x="1150.5000466064255" y="549.5000117090033"></omgdi:waypoint>
        <omgdi:waypoint x="1150.5000466064255" y="625.0000268618312"></omgdi:waypoint>
        <omgdi:waypoint x="1200.000027550596" y="625.0000268618312"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge bpmnElement="follow_sco_from_requester_to_end" id="BPMNEdge_follow_sco_from_requester_to_end">
        <omgdi:waypoint x="1445.000058430223" y="415.0000086095612"></omgdi:waypoint>
        <omgdi:waypoint x="1499.0000340938625" y="415.0000086095612"></omgdi:waypoint>
        <omgdi:waypoint x="1499.0000340938625" y="253.00000516573675"></omgdi:waypoint>
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>